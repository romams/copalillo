(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{kQgB:function(t,e,o){"use strict";o.r(e),o.d(e,"UsersModule",function(){return Y});var c=o("ofXK"),a=o("tyNb"),r=o("+0xr"),n=o("0IaG"),i=o("fXoL"),s=o("/9La"),l=o("z6cu"),u=o("JIr8"),d=o("AytR"),m=o("tk/3");let b=(()=>{class t{constructor(t){this.http=t}getAll(){return this.http.get(d.a.API_URL+"/users").pipe(Object(u.a)(this.handlerError))}getById(t){return this.http.get(`${d.a.API_URL}/users/${t}`).pipe(Object(u.a)(this.handlerError))}new(t){return this.http.post(d.a.API_URL+"/users",t,{responseType:"text"}).pipe(Object(u.a)(this.handlerError))}update(t,e){return this.http.patch(`${d.a.API_URL}/users/${t}`,e,{responseType:"text"}).pipe(Object(u.a)(this.handlerError))}delete(t){return this.http.delete(`${d.a.API_URL}/users/${t}`,{responseType:"text"}).pipe(Object(u.a)(this.handlerError))}handlerError(t){let e="Error desconocido";return t&&(e="Error "+t.message),window.alert(e),Object(l.a)(e)}}return t.\u0275fac=function(e){return new(e||t)(i.fc(m.b))},t.\u0275prov=i.Rb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var h=o("dNgK"),p=o("bTqV"),f=o("NFeN"),g=o("3Pt+"),v=o("kmnG"),w=o("qFsG"),P=o("d3UM"),R=o("FKr1");function O(t,e){if(1&t&&(i.bc(0,"mat-error"),i.Rc(1),i.ac()),2&t){const t=i.nc();i.Jb(1),i.Tc(" ",t.userForm.getErrorMessage("username")," ")}}function C(t,e){if(1&t&&(i.bc(0,"mat-error"),i.Rc(1),i.ac()),2&t){const t=i.nc(2);i.Jb(1),i.Tc(" ",t.userForm.getErrorMessage("password")," ")}}function y(t,e){if(1&t){const t=i.cc();i.bc(0,"mat-form-field",5),i.Wb(1,"input",14),i.bc(2,"button",15),i.jc("click",function(){i.Gc(t);const e=i.nc();return e.hide=!e.hide}),i.bc(3,"mat-icon"),i.Rc(4),i.ac(),i.ac(),i.Pc(5,C,2,1,"mat-error",7),i.ac()}if(2&t){const t=i.nc();i.Jb(1),i.vc("type",t.hide?"password":"text"),i.Jb(3),i.Tc(" ",t.hide?"visibility_off":"visibility"," "),i.Jb(1),i.vc("ngIf",t.checkField("password"))}}function F(t,e){if(1&t&&(i.bc(0,"mat-error"),i.Rc(1),i.ac()),2&t){const t=i.nc();i.Jb(1),i.Tc(" ",t.userForm.getErrorMessage("role")," ")}}var k=function(t){return t.EDIT="edit",t.NEW="new",t}({});let I=(()=>{class t{constructor(t,e,o,c,a){this.data=t,this.userForm=e,this.userSvc=o,this.dialogRef=c,this._snackBar=a,this.actionTODO=k.NEW,this.showPasswordField=!0,this.hide=!0}ngOnInit(){var t,e;(null===(t=this.data)||void 0===t?void 0:t.user.hasOwnProperty("id"))?(this.actionTODO=k.EDIT,this.showPasswordField=!1,null===(e=this.userForm.baseForm.get("password"))||void 0===e||e.setValidators(null),this.userForm.baseForm.updateValueAndValidity(),this.data.title="Editar usuario",this.pathFormData()):this.userForm.baseForm.reset()}onSave(){var t,e;const o=this.userForm.baseForm.value;if(this.actionTODO==k.NEW)this.userSvc.new(o).subscribe(t=>{this.dialogRef.close(t),this._snackBar.open("Usuario agregado correctamente","Aceptar",{duration:2e3})});else{const c=null===(e=null===(t=this.data)||void 0===t?void 0:t.user)||void 0===e?void 0:e.id;this.userSvc.update(c,o).subscribe(t=>{this._snackBar.open("Usuario actualizado correctamente","Aceptar",{duration:2e3}),this.dialogRef.close(t)})}}checkField(t){return this.userForm.isValidField(t)}pathFormData(){var t,e,o,c;this.userForm.baseForm.patchValue({username:null===(e=null===(t=this.data)||void 0===t?void 0:t.user)||void 0===e?void 0:e.username,role:null===(c=null===(o=this.data)||void 0===o?void 0:o.user)||void 0===c?void 0:c.role})}}return t.\u0275fac=function(e){return new(e||t)(i.Vb(n.a),i.Vb(s.a),i.Vb(b),i.Vb(n.g),i.Vb(h.a))},t.\u0275cmp=i.Pb({type:t,selectors:[["app-modal"]],decls:24,vars:8,consts:[["mat-icon-button","",1,"close-button",3,"mat-dialog-close"],["color","warn",1,"close-icon"],["mat-dialog-title",""],[1,"modal-form"],[3,"formGroup"],[1,"full-width-input"],["formControlName","username","matInput","","placeholder","Nombre de usuario","required",""],[4,"ngIf"],["class","full-width-input",4,"ngIf"],["formControlName","role"],["value","editor"],["value","admin"],["align","end"],["mat-raised-button","","color","primary","ckdFocusInitial","",1,"btn-save",3,"disabled","mat-dialog-close","click"],["formControlName","password","matInput","","placeholder","Contrase\xf1a","required","",3,"type"],["type","button","mat-icon-button","","matSuffix","",3,"click"]],template:function(t,e){1&t&&(i.bc(0,"button",0),i.bc(1,"mat-icon",1),i.Rc(2,"close"),i.ac(),i.ac(),i.bc(3,"h2",2),i.Rc(4),i.ac(),i.bc(5,"mat-dialog-content"),i.bc(6,"div",3),i.bc(7,"form",4),i.bc(8,"mat-form-field",5),i.Wb(9,"input",6),i.Pc(10,O,2,1,"mat-error",7),i.ac(),i.Pc(11,y,6,3,"mat-form-field",8),i.bc(12,"mat-form-field",5),i.bc(13,"mat-label"),i.Rc(14,"Select"),i.ac(),i.bc(15,"mat-select",9),i.bc(16,"mat-option",10),i.Rc(17,"Editor"),i.ac(),i.bc(18,"mat-option",11),i.Rc(19,"Admin"),i.ac(),i.ac(),i.Pc(20,F,2,1,"mat-error",7),i.ac(),i.ac(),i.ac(),i.ac(),i.bc(21,"mat-dialog-actions",12),i.bc(22,"button",13),i.jc("click",function(){return e.onSave()}),i.Rc(23,"Guardar "),i.ac(),i.ac()),2&t&&(i.vc("mat-dialog-close",!0),i.Jb(4),i.Tc(" ",null==e.data?null:e.data.title,""),i.Jb(3),i.vc("formGroup",e.userForm.baseForm),i.Jb(3),i.vc("ngIf",e.checkField("username")),i.Jb(1),i.vc("ngIf",e.showPasswordField),i.Jb(9),i.vc("ngIf",e.checkField("role")),i.Jb(2),i.vc("disabled",!e.userForm.baseForm.valid)("mat-dialog-close",!0))},directives:[p.b,n.d,f.a,n.h,n.e,g.v,g.l,g.e,v.c,g.b,w.b,g.k,g.d,g.r,c.m,v.f,P.a,R.m,n.c,v.b,v.g],styles:[".modal-form[_ngcontent-%COMP%]{padding:1rem 0}.modal-form[_ngcontent-%COMP%]   .full-width-input[_ngcontent-%COMP%]{width:100%}.close-button[_ngcontent-%COMP%]{float:right;top:-24px;right:-24px}.close-icon[_ngcontent-%COMP%]{transition:1s ease-in-out}.close-icon[_ngcontent-%COMP%]:hover{transform:rotate(180deg)}  .icon-outside .close-button{float:right;top:-52px;right:-52px}  .icon-outside .mat-dialog-container{overflow:unset}#btn-save[_ngcontent-%COMP%]{width:100%}"]}),t})();var D=o("1G5W"),E=o("XNiG"),J=o("PSD3"),M=o.n(J),S=o("M9IT"),T=o("JqCM");function _(t,e){1&t&&(i.bc(0,"th",12),i.Rc(1," Id "),i.ac())}function x(t,e){if(1&t&&(i.bc(0,"td",13),i.Rc(1),i.ac()),2&t){const t=e.$implicit;i.Jb(1),i.Tc(" ",t.id," ")}}function A(t,e){1&t&&(i.bc(0,"th",12),i.Rc(1," Rol "),i.ac())}function j(t,e){if(1&t&&(i.bc(0,"td",13),i.Rc(1),i.ac()),2&t){const t=e.$implicit;i.Jb(1),i.Tc(" ",t.role," ")}}function $(t,e){1&t&&(i.bc(0,"th",12),i.Rc(1," Usuario "),i.ac())}function N(t,e){if(1&t&&(i.bc(0,"td",13),i.Rc(1),i.ac()),2&t){const t=e.$implicit;i.Jb(1),i.Tc(" ",t.username," ")}}function V(t,e){1&t&&(i.bc(0,"th",12),i.Rc(1," Acciones "),i.ac())}function B(t,e){if(1&t){const t=i.cc();i.bc(0,"td",13),i.bc(1,"div",0),i.bc(2,"button",14),i.jc("click",function(){i.Gc(t);const o=e.$implicit;return i.nc().onOpenModal(o)}),i.Rc(3,"Editar"),i.ac(),i.bc(4,"button",15),i.jc("click",function(){i.Gc(t);const o=e.$implicit;return i.nc().onDelete(o.id)}),i.Rc(5,"Eliminar"),i.ac(),i.ac(),i.ac()}}function U(t,e){1&t&&i.Wb(0,"tr",16)}function G(t,e){1&t&&i.Wb(0,"tr",17)}const L=function(){return[5,10,15,20]},W=[{path:"",component:(()=>{class t{constructor(t,e,o){this.userSvc=t,this.dialog=e,this.spinner=o,this.displayedColumns=["Id","Role","Username","Actions"],this.dataSource=new r.k,this.destroy$=new E.a}ngOnInit(){this.getData()}getData(){this.spinner.show(),this.userSvc.getAll().subscribe(t=>{this.dataSource.data=t,this.dataSource.paginator=this.paginator,this.spinner.hide()})}onDelete(t){M.a.fire({title:"\xbfEst\xe1 seguro?",text:"No podr\xe1 revertir la accion",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"S\xed, borrar."}).then(e=>{e.isConfirmed&&(this.userSvc.delete(t).pipe(Object(D.a)(this.destroy$)).subscribe(t=>{this.ngOnInit()}),M.a.fire("\xa1Eliminado!","El usuario ha sido eliminado correctamente.","success"),this.ngOnInit())})}onOpenModal(t={}){this.dialog.open(I,{height:"300px",width:"600px",hasBackdrop:!1,data:{title:"Nuevo usuario",user:t}}).afterClosed().subscribe(()=>{this.getData()})}ngOnDestroy(){this.destroy$.next({}),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(i.Vb(b),i.Vb(n.b),i.Vb(T.c))},t.\u0275cmp=i.Pb({type:t,selectors:[["app-users"]],viewQuery:function(t,e){if(1&t&&i.Lc(S.a,!0),2&t){let t;i.Bc(t=i.kc())&&(e.paginator=t.first)}},decls:21,vars:5,consts:[[1,"table-button-row"],["mat-flat-button","","color","primary",1,"button-new",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","Id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Role"],["matColumnDef","Username"],["matColumnDef","Actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","id","paginator-users",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-flat-button","","color","accent",3,"click"],["mat-flat-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(i.bc(0,"div",0),i.bc(1,"button",1),i.jc("click",function(){return e.onOpenModal()}),i.bc(2,"mat-icon"),i.Rc(3,"people"),i.ac(),i.Rc(4," Agregar nuevo "),i.ac(),i.ac(),i.bc(5,"table",2),i.Zb(6,3),i.Pc(7,_,2,0,"th",4),i.Pc(8,x,2,1,"td",5),i.Yb(),i.Zb(9,6),i.Pc(10,A,2,0,"th",4),i.Pc(11,j,2,1,"td",5),i.Yb(),i.Zb(12,7),i.Pc(13,$,2,0,"th",4),i.Pc(14,N,2,1,"td",5),i.Yb(),i.Zb(15,8),i.Pc(16,V,2,0,"th",4),i.Pc(17,B,6,0,"td",5),i.Yb(),i.Pc(18,U,1,0,"tr",9),i.Pc(19,G,1,0,"tr",10),i.ac(),i.Wb(20,"mat-paginator",11)),2&t&&(i.Jb(5),i.vc("dataSource",e.dataSource),i.Jb(13),i.vc("matHeaderRowDef",e.displayedColumns),i.Jb(1),i.vc("matRowDefColumns",e.displayedColumns),i.Jb(1),i.vc("pageSizeOptions",i.yc(4,L)))},directives:[p.b,f.a,r.j,r.c,r.e,r.b,r.g,r.i,S.a,r.d,r.a,r.f,r.h],styles:["table[_ngcontent-%COMP%]{width:80%;margin:1rem auto 0}th.mat-sort-header-sorted[_ngcontent-%COMP%]{color:#000}.table-button-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:12px}.button-new[_ngcontent-%COMP%]{width:15%}#paginator-users[_ngcontent-%COMP%]{width:80%;margin-left:10%}"]}),t})()}];let q=(()=>{class t{}return t.\u0275mod=i.Tb({type:t}),t.\u0275inj=i.Sb({factory:function(e){return new(e||t)},imports:[[a.e.forChild(W)],a.e]}),t})();var z=o("vvyD");let Y=(()=>{class t{}return t.\u0275mod=i.Tb({type:t}),t.\u0275inj=i.Sb({factory:function(e){return new(e||t)},imports:[[c.c,q,z.a]]}),t})()}}]);